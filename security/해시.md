일단 해시는 왜 하는가? 아는 내용이지만 정리하면 비밀번호와 같은 정보는 데이터베이스에 저장되지만, 해당 정보 그대로 저장되어서는 안된다. 관리자가 데이터베이스에 접근해서 조회하는 것조차 막아야하는 민감 정보이기 때문이다. 그래서 자체로는 의미를 알 수없는 값으로 저장되어야한다. 물론 복호화가 되는 암호화 방식을 사용해서도 안된다. 결국 특정 값을 정해진 알고리즘에 의해 다른 값으로 변환하며, 기존 값을 알 수 없는 해시 함수를 사용해야한다.

그렇다면 SHA-256과 같은 잘 알려진 해시 함수를 사용하면 되나? 물론 안된다. 해시란 기본적으로 동일한 값을 해시 함수에 넣어서 나온 값이 동일하다. 그렇기에 해커들은 해시 값으로 원래 값을 확인할 수 있는 레인보우 테이블과 같은 방식으로 해킹을 할 수 있다. 그래서 값을 곧이 곧대로 해시화 하는 일반 해시는 사용해서는 안된다.

민감한 정보를 해시화 하는 잘 알려진 알고리즘들은 기본적으로 기존 값에 salt라는 추가 값을 함께 해싱하는 방식을 사용해서 해커들이 공격을 막는다. 잘 알려진 알고리즘을 비교해보자.

## bcrypt

1999년에 등장한 가장 오래된 알고리즘으로, 오랜 실전 검증이 최대 강점이다. cost factor라는 단일 파라미터로 연산 비용을 조절하고, 자동으로 salt를 생성해 준다. 메모리 사용량이 고정 4KB로 매우 낮아 GPU/ASIC 기반 공격에 상대적으로 취약하다는 단점이 있다. 또한 입력 패스워드를 72바이트로 제한하기 때문에, 긴 패스워드를 사용할 경우 별도 처리가 필요하다.

## scrypt

2009년 메모리 하드(memory-hard) 특성을 목적으로 설계되었다. N(CPU/메모리 비용), r(블록 크기), p(병렬성) 세 파라미터를 조합해 사용하며, Argon2id를 쓸 수 없는 환경에서 OWASP가 차선책으로 권장하는 알고리즘이다. 다만 파라미터 조합이 복잡하고, 사이드채널 공격(side-channel attack)에 일부 취약점이 알려져 있다.

## argon2id

2013~2015년 Password Hashing Competition의 우승 알고리즘이다. argon2d, argon2i, argon2id 세 가지 변종이 있는데, argon2id는 이 둘을 결합한 형태로 GPU 공격 저항성과 사이드채널 공격 저항성을 동시에 제공한다. OWASP는 최소 19MiB 메모리, 반복 횟수 2, 병렬성 1의 설정으로 Argon2id를 1순위로 권장한다.

## 보안 관점에서 알고리즘 비교

메모리 하드 알고리즘(Argon2, scrypt)은 GPU의 이점을 극적으로 감소시키는데, Argon2를 128MB로 설정 시 GPU가 CPU 대비 약 1.5배 빠를 뿐이지만, MD5는 GPU가 CPU보다 62만 배 빠르다. bcrypt는 4KB 고정 메모리로 이 이점이 훨씬 적다.

## 성능 관점에서 알고리즘 비교

bcrypt(cost=12)는 약 250ms/4KB, scrypt(N=2^15)는 약 200ms/32MB, Argon2id(m=64MB, t=3, p=4)는 약 150ms/64MB 수준으로, 적절한 파라미터 설정 시 셋 모두 비슷한 응답 속도를 낸다.

## 정리

신규 시스템이라면 argon2id가 명확한 1순위이다. scrypt는 argon2id 라이브러리를 지원하지 않는 환경에서의 차선택, bcrypt는 기존 레거시 시스템을 유지할 때 활용한다.

## 참고

https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html
https://stytch.com/blog/argon2-vs-bcrypt-vs-scrypt/
https://guptadeepak.com/the-complete-guide-to-password-hashing-argon2-vs-bcrypt-vs-scrypt-vs-pbkdf2-2026/
